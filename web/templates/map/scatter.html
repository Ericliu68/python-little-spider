<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>echarts3中国地图下钻至县级</title>
    <link rel="stylesheet" type="text/css" href="/static/css/main.css">
    <!-- Echarts3 -->
    <script type="text/javascript" src="/static/js/echarts.min.js"></script>
    <!-- 全国344个市、区、州对应的数字编号 -->
    <script type="text/javascript">
        var cityMap = {
            "北京市": "110100",
            "天津市": "120100",
            "上海市": "310100",
            "重庆市": "500100",
            "崇明县": "310200",
            "湖北省直辖县市": "429000",
            "铜仁市": "522200",
            "毕节市": "522400",
            "石家庄市": "130100",
            "唐山市": "130200",
            "秦皇岛市": "130300",
            "邯郸市": "130400",
            "邢台市": "130500",
            "保定市": "130600",
            "张家口市": "130700",
            "承德市": "130800",
            "沧州市": "130900",
            "廊坊市": "131000",
            "衡水市": "131100",
            "太原市": "140100",
            "大同市": "140200",
            "阳泉市": "140300",
            "长治市": "140400",
            "晋城市": "140500",
            "朔州市": "140600",
            "晋中市": "140700",
            "运城市": "140800",
            "忻州市": "140900",
            "临汾市": "141000",
            "吕梁市": "141100",
            "呼和浩特市": "150100",
            "包头市": "150200",
            "乌海市": "150300",
            "赤峰市": "150400",
            "通辽市": "150500",
            "鄂尔多斯市": "150600",
            "呼伦贝尔市": "150700",
            "巴彦淖尔市": "150800",
            "乌兰察布市": "150900",
            "兴安盟": "152200",
            "锡林郭勒盟": "152500",
            "阿拉善盟": "152900",
            "沈阳市": "210100",
            "大连市": "210200",
            "鞍山市": "210300",
            "抚顺市": "210400",
            "本溪市": "210500",
            "丹东市": "210600",
            "锦州市": "210700",
            "营口市": "210800",
            "阜新市": "210900",
            "辽阳市": "211000",
            "盘锦市": "211100",
            "铁岭市": "211200",
            "朝阳市": "211300",
            "葫芦岛市": "211400",
            "长春市": "220100",
            "吉林市": "220200",
            "四平市": "220300",
            "辽源市": "220400",
            "通化市": "220500",
            "白山市": "220600",
            "松原市": "220700",
            "白城市": "220800",
            "延边朝鲜族自治州": "222400",
            "哈尔滨市": "230100",
            "齐齐哈尔市": "230200",
            "鸡西市": "230300",
            "鹤岗市": "230400",
            "双鸭山市": "230500",
            "大庆市": "230600",
            "伊春市": "230700",
            "佳木斯市": "230800",
            "七台河市": "230900",
            "牡丹江市": "231000",
            "黑河市": "231100",
            "绥化市": "231200",
            "大兴安岭地区": "232700",
            "南京市": "320100",
            "无锡市": "320200",
            "徐州市": "320300",
            "常州市": "320400",
            "苏州市": "320500",
            "南通市": "320600",
            "连云港市": "320700",
            "淮安市": "320800",
            "盐城市": "320900",
            "扬州市": "321000",
            "镇江市": "321100",
            "泰州市": "321200",
            "宿迁市": "321300",
            "杭州市": "330100",
            "宁波市": "330200",
            "温州市": "330300",
            "嘉兴市": "330400",
            "湖州市": "330500",
            "绍兴市": "330600",
            "金华市": "330700",
            "衢州市": "330800",
            "舟山市": "330900",
            "台州市": "331000",
            "丽水市": "331100",
            "合肥市": "340100",
            "芜湖市": "340200",
            "蚌埠市": "340300",
            "淮南市": "340400",
            "马鞍山市": "340500",
            "淮北市": "340600",
            "铜陵市": "340700",
            "安庆市": "340800",
            "黄山市": "341000",
            "滁州市": "341100",
            "阜阳市": "341200",
            "宿州市": "341300",
            "六安市": "341500",
            "亳州市": "341600",
            "池州市": "341700",
            "宣城市": "341800",
            "福州市": "350100",
            "厦门市": "350200",
            "莆田市": "350300",
            "三明市": "350400",
            "泉州市": "350500",
            "漳州市": "350600",
            "南平市": "350700",
            "龙岩市": "350800",
            "宁德市": "350900",
            "南昌市": "360100",
            "景德镇市": "360200",
            "萍乡市": "360300",
            "九江市": "360400",
            "新余市": "360500",
            "鹰潭市": "360600",
            "赣州市": "360700",
            "吉安市": "360800",
            "宜春市": "360900",
            "抚州市": "361000",
            "上饶市": "361100",
            "济南市": "370100",
            "青岛市": "370200",
            "淄博市": "370300",
            "枣庄市": "370400",
            "东营市": "370500",
            "烟台市": "370600",
            "潍坊市": "370700",
            "济宁市": "370800",
            "泰安市": "370900",
            "威海市": "371000",
            "日照市": "371100",
            "莱芜市": "371200",
            "临沂市": "371300",
            "德州市": "371400",
            "聊城市": "371500",
            "滨州市": "371600",
            "菏泽市": "371700",
            "郑州市": "410100",
            "开封市": "410200",
            "洛阳市": "410300",
            "平顶山市": "410400",
            "安阳市": "410500",
            "鹤壁市": "410600",
            "新乡市": "410700",
            "焦作市": "410800",
            "濮阳市": "410900",
            "许昌市": "411000",
            "漯河市": "411100",
            "三门峡市": "411200",
            "南阳市": "411300",
            "商丘市": "411400",
            "信阳市": "411500",
            "周口市": "411600",
            "驻马店市": "411700",
            "省直辖县级行政区划": "469000",
            "武汉市": "420100",
            "黄石市": "420200",
            "十堰市": "420300",
            "宜昌市": "420500",
            "襄阳市": "420600",
            "鄂州市": "420700",
            "荆门市": "420800",
            "孝感市": "420900",
            "荆州市": "421000",
            "黄冈市": "421100",
            "咸宁市": "421200",
            "随州市": "421300",
            "恩施土家族苗族自治州": "422800",
            "长沙市": "430100",
            "株洲市": "430200",
            "湘潭市": "430300",
            "衡阳市": "430400",
            "邵阳市": "430500",
            "岳阳市": "430600",
            "常德市": "430700",
            "张家界市": "430800",
            "益阳市": "430900",
            "郴州市": "431000",
            "永州市": "431100",
            "怀化市": "431200",
            "娄底市": "431300",
            "湘西土家族苗族自治州": "433100",
            "广州市": "440100",
            "韶关市": "440200",
            "深圳市": "440300",
            "珠海市": "440400",
            "汕头市": "440500",
            "佛山市": "440600",
            "江门市": "440700",
            "湛江市": "440800",
            "茂名市": "440900",
            "肇庆市": "441200",
            "惠州市": "441300",
            "梅州市": "441400",
            "汕尾市": "441500",
            "河源市": "441600",
            "阳江市": "441700",
            "清远市": "441800",
            "东莞市": "441900",
            "中山市": "442000",
            "潮州市": "445100",
            "揭阳市": "445200",
            "云浮市": "445300",
            "南宁市": "450100",
            "柳州市": "450200",
            "桂林市": "450300",
            "梧州市": "450400",
            "北海市": "450500",
            "防城港市": "450600",
            "钦州市": "450700",
            "贵港市": "450800",
            "玉林市": "450900",
            "百色市": "451000",
            "贺州市": "451100",
            "河池市": "451200",
            "来宾市": "451300",
            "崇左市": "451400",
            "海口市": "460100",
            "三亚市": "460200",
            "三沙市": "460300",
            "成都市": "510100",
            "自贡市": "510300",
            "攀枝花市": "510400",
            "泸州市": "510500",
            "德阳市": "510600",
            "绵阳市": "510700",
            "广元市": "510800",
            "遂宁市": "510900",
            "内江市": "511000",
            "乐山市": "511100",
            "南充市": "511300",
            "眉山市": "511400",
            "宜宾市": "511500",
            "广安市": "511600",
            "达州市": "511700",
            "雅安市": "511800",
            "巴中市": "511900",
            "资阳市": "512000",
            "阿坝藏族羌族自治州": "513200",
            "甘孜藏族自治州": "513300",
            "凉山彝族自治州": "513400",
            "贵阳市": "520100",
            "六盘水市": "520200",
            "遵义市": "520300",
            "安顺市": "520400",
            "黔西南布依族苗族自治州": "522300",
            "黔东南苗族侗族自治州": "522600",
            "黔南布依族苗族自治州": "522700",
            "昆明市": "530100",
            "曲靖市": "530300",
            "玉溪市": "530400",
            "保山市": "530500",
            "昭通市": "530600",
            "丽江市": "530700",
            "普洱市": "530800",
            "临沧市": "530900",
            "楚雄彝族自治州": "532300",
            "红河哈尼族彝族自治州": "532500",
            "文山壮族苗族自治州": "532600",
            "西双版纳傣族自治州": "532800",
            "大理白族自治州": "532900",
            "德宏傣族景颇族自治州": "533100",
            "怒江傈僳族自治州": "533300",
            "迪庆藏族自治州": "533400",
            "拉萨市": "540100",
            "昌都地区": "542100",
            "山南地区": "542200",
            "日喀则地区": "542300",
            "那曲地区": "542400",
            "阿里地区": "542500",
            "林芝地区": "542600",
            "西安市": "610100",
            "铜川市": "610200",
            "宝鸡市": "610300",
            "咸阳市": "610400",
            "渭南市": "610500",
            "延安市": "610600",
            "汉中市": "610700",
            "榆林市": "610800",
            "安康市": "610900",
            "商洛市": "611000",
            "兰州市": "620100",
            "嘉峪关市": "620200",
            "金昌市": "620300",
            "白银市": "620400",
            "天水市": "620500",
            "武威市": "620600",
            "张掖市": "620700",
            "平凉市": "620800",
            "酒泉市": "620900",
            "庆阳市": "621000",
            "定西市": "621100",
            "陇南市": "621200",
            "临夏回族自治州": "622900",
            "甘南藏族自治州": "623000",
            "西宁市": "630100",
            "海东地区": "632100",
            "海北藏族自治州": "632200",
            "黄南藏族自治州": "632300",
            "海南藏族自治州": "632500",
            "果洛藏族自治州": "632600",
            "玉树藏族自治州": "632700",
            "海西蒙古族藏族自治州": "632800",
            "银川市": "640100",
            "石嘴山市": "640200",
            "吴忠市": "640300",
            "固原市": "640400",
            "中卫市": "640500",
            "乌鲁木齐市": "650100",
            "克拉玛依市": "650200",
            "吐鲁番地区": "652100",
            "哈密地区": "652200",
            "昌吉回族自治州": "652300",
            "博尔塔拉蒙古自治州": "652700",
            "巴音郭楞蒙古自治州": "652800",
            "阿克苏地区": "652900",
            "克孜勒苏柯尔克孜自治州": "653000",
            "喀什地区": "653100",
            "和田地区": "653200",
            "伊犁哈萨克自治州": "654000",
            "塔城地区": "654200",
            "阿勒泰地区": "654300",
            "自治区直辖县级行政区划": "659000",
            "台湾省": "710000",
            "香港特别行政区": "810100",
            "澳门特别行政区": "820000"
        };
    </script>
</head>
<body>
<div id="main" style="width: 100%;height:800px;">
</div>
<nav style="position:fixed;left:50px;top:50px;">
    <a href="/index/">首页</a>
    <a href="/heat/">热力图</a>
    <a href="/scatter/">散点图</a>
    <a href="/histogram/">柱状图</a>
    <a href="/form/">基本信息表</a>
    
</nav>
<script type="text/javascript" src="/static/js/jquery.min.js"></script>
<script type="text/javascript">
    //地图容器
    var chart = echarts.init(document.getElementById('main'));
    //34个省、市、自治区的名字拼音映射数组
    var provinces = {
        //23个省
        "台湾": "taiwan",
        "河北": "hebei",
        "山西": "shanxi",
        "辽宁": "liaoning",
        "吉林": "jilin",
        "黑龙江": "heilongjiang",
        "江苏": "jiangsu",
        "浙江": "zhejiang",
        "安徽": "anhui",
        "福建": "fujian",
        "江西": "jiangxi",
        "山东": "shandong",
        "河南": "henan",
        "湖北": "hubei",
        "湖南": "hunan",
        "广东": "guangdong",
        "海南": "hainan",
        "四川": "sichuan",
        "贵州": "guizhou",
        "云南": "yunnan",
        "陕西": "shanxi1",
        "甘肃": "gansu",
        "青海": "qinghai",
        //5个自治区
        "新疆": "xinjiang",
        "广西": "guangxi",
        "内蒙古": "neimenggu",
        "宁夏": "ningxia",
        "西藏": "xizang",
        //4个直辖市
        "北京": "beijing",
        "天津": "tianjin",
        "上海": "shanghai",
        "重庆": "chongqing",
        //2个特别行政区
        "香港": "xianggang",
        "澳门": "aomen"
    };

    //直辖市和特别行政区-只有二级地图，没有三级地图
    var special = ["北京", "天津", "上海", "重庆", "香港", "澳门"];
    var mapdata = [];
    //绘制全国地图
    $.getJSON('/static/map/china.json', function (data) {
        d = [];
        for (var i = 0; i < data.features.length; i++) {
            d.push({
                name: data.features[i].properties.name
            })
        }
        mapdata = d;
        //注册地图
        echarts.registerMap('china', data);
        //绘制地图
        renderMap('china', d);
    });
    var convertData = function (geoCoordMap, data) {
        var res = [];
        for (var i = 0; i < data.length; i++) {
            var geoCoord = geoCoordMap[data[i].name];
            if (geoCoord) {
                res.push({
                    name: data[i].name,
                    value: geoCoord.concat(data[i].value)
                });
            }
        }
        return res;
    };
    // var dd = [];

    // $.getJSON('/static/new/aaa.json', function(data1){
    // dd = convertData(data1.geoCoordMap,data1.data);
    // alert(dd);
    // });
    // // alert(dd);

    //地图点击事件
    chart.on('click', function (params) {
        console.log(params);
        if (params.name in provinces) {
            //如果点击的是34个省、市、自治区，绘制选中地区的二级地图
            $.getJSON('/static/map/province/' + provinces[params.name] + '.json', function (geoJson) {
                echarts.registerMap(params.name, geoJson);
                chart.hideLoading();
                // var geoCoordMap = {"上海泰迪之家博物馆": [121.49942285894618, 31.18674849156693], "上海自然博物馆": [121.47111495625786, 31.240908491026197], "南翔老街": [121.31473952218337, 31.297071558382214], "廊下生态园": [121.16502562263511, 30.792985868695883], "上海相东佛像艺术馆": [121.23247969239644, 31.374759612200766], "上海历史博物馆": [121.41924797109536, 31.202255047425055], "上海迪士尼摄影服务": [121.70119533515441, 31.19844913145745], "MIKU谜窟真人实景游戏": [121.50499256959966, 31.23329162290211], "上海长风海洋世界": [121.40314329364136, 31.23025988254595], "精彩上海旅游联票": [121.36076824556527, 31.222545916421975], "奇人异事展": [121.50118672044215, 31.24509474943829], "上海星空错觉艺术馆": [121.50508102843814, 31.233282813579113], "汤连得温泉馆": [121.3826499985167, 31.237109511576715], "极乐汤碧云温泉馆": [121.60747605823106, 31.25619093305694], "上海观复博物馆": [121.51202297531748, 31.23920977806057], "上海汽车博物馆": [121.1761802055425, 31.286303839102327], "时光弄堂": [121.50508102843814, 31.233282813579113], "pulupulu主题游戏馆": [121.50695859205574, 31.210616710003055], "太敬机器人科技文化体验馆": [121.3843546841372, 31.28510396393154], "泰晤士小镇": [121.20460504515053, 31.039448706624352], "上海顾村恐龙园": [121.39184919580352, 31.350554172079374], "磁浮列车": [121.5738694546786, 31.210969575375657], "鲜花港": [121.90808372412339, 30.952729084816], "大鸭软陶屋": [121.44916573786776, 31.23012732100983], "闻道园": [121.36417712543317, 31.44250283898852], "东方明珠豪华浦江游船东方明珠码头": [121.5033243453015, 31.246165133675472], "云翔寺": [121.31364950659959, 31.29816723854419], "上海手工艺展示馆": [121.06128619959563, 31.115514960402358], "喜魔谷主题游戏馆": [121.58432112520238, 31.124300362887798], "涟泉大江户（上海莘庄店）": [121.36992827313865, 31.10918024967724], "高家庄园": [121.43343627993033, 31.686453212283904], "东方明珠空中旋转餐厅": [121.50625059256805, 31.24540977690472], "上海电影博物馆": [121.44357457298375, 31.19245689952519], "RU KIDDING密室逃脱": [121.48626102674962, 31.207247761312065], "金茂大厦88层观光厅": [121.51206857510178, 31.240752912649523], "城市飞行会": [121.41266450560606, 31.142598278616216], "77真人密室逃脱（徐家汇店）": [121.44569037800227, 31.198526914141944], "上海影视乐园": [121.31662262834595, 31.018482601020704], "上海海湾国家森林公园": [121.6847367136515, 30.87230826057462], "朱家角课植园": [121.0598985915659, 31.119525724311554], "上海尊木艺术馆": [121.41821415979243, 31.315693231603298], "童天和药号": [121.06204060105443, 31.115163841517965], "鲁迅公园": [121.48914979221878, 31.274280744400155], "长风公园": [121.40314329364136, 31.23025988254595], "上海科技馆": [121.54788051868124, 31.22452757616514], "上海大自然野生昆虫馆": [121.5047502112646, 31.246177519056907], "环球猎奇馆": [121.50118672044215, 31.24509474943829], "外滩观光隧道AR体验馆": [121.50118672044215, 31.24509474943829], "上海星期8小镇": [121.39373703603616, 31.112856682597215], "琉璃中国博物馆": [121.47693485936878, 31.21388275353976], "亲子彩虹泡泡跑": [121.45320906935802, 31.284699546384072], "上海格里芬汽车影院": [121.4622927481495, 31.060846607154488], "赵屯张家草莓园": [121.09710815928153, 31.258569778420984], "威久真人CS镭射拓展基地（普陀店）": [121.43093566059407, 31.250235309920562], "上海JOYPOLIS乐园": [121.41899309666962, 31.238095099285207], "金山嘴渔村": [121.38269838843789, 30.73835760340231], "上海世博会博物馆": [121.48123797847695, 31.213348379555082], "一米单车之家": [121.46117875948657, 31.66538220920881], "环球金融中心观光厅": [121.51420808370779, 31.240286930090868], "檀园": [121.31455837438575, 31.29772946273922], "花开海上生态园": [121.11622243687206, 30.88340498560167], "橙蓝生态体验乐园": [121.15432463370517, 30.922619157528672], "江南三民文化村": [121.5049617478393, 31.72380466691765], "上海杜莎夫人蜡像馆": [121.48020666679894, 31.240714087406378], "金山城市沙滩": [121.3483393704784, 30.720559467796527], "顾村公园": [121.39572231007762, 31.351031306832432], "瀛东生态村": [121.85046149767716, 31.471041877563607], "东平国家森林公园": [121.5353975435439, 31.633564930802045], "桂林公园": [121.42591919923639, 31.166638401211696], "大宁灵石公园": [121.45320906935802, 31.284699546384072], "朱家角古镇": [121.06186345520787, 31.115054629543458], "家家乐梦幻乐园": [121.53838781084869, 31.258897710933553], "申迪生态园上农嘉年华": [121.68008898514631, 31.15304338458962], "前卫生态村": [121.4876203722914, 31.691126859639514], "3D魔幻趣味馆": [121.50118672044215, 31.24509474943829], "崇明明珠湖公园": [121.2636881795595, 31.757188479603062], "城隍庙九曲桥": [121.498830631276, 31.232387838391325], "上海陶瓷科技馆展览": [121.50387016561072, 31.346333549987783], "上海成龙电影艺术馆": [121.4007324734154, 31.229588348541455], "青浦草莓园小苹果农家乐": [121.11847966841513, 31.276369680025656], "赵屯乡村草莓园": [121.10596976078143, 31.24113451978082], "嘉仕有机农场": [121.56909950182741, 31.52860136250956], "草莓人家": [121.07862137649653, 31.27306125792692], "上海马戏城": [121.45827813368977, 31.28414208252042], "上海八音盒珍品陈列馆": [121.5476250378993, 31.229185646500408], "黄浦江游览": [121.5030494090188, 31.234962266678775], "上海城市规划展示馆": [121.48231922713792, 31.23736310616563], "哈一顿桑拿（七宝店）": [121.5120080293104, 31.088740817081522], "乾汤国际温泉": [121.61248673450127, 31.268569255067547], "上海风电科普馆": [121.80336707584163, 30.991845350526862], "ERA时空之旅": [121.4576746233024, 31.28450913946948], "集合石大型真人游戏馆（南京东路步行街店）": [121.49090952779756, 31.243976895339653], "锦江乐园": [121.4173070454986, 31.14700704924499], "环球奇趣体验馆": [121.49747792331362, 31.23238005535805], "东林寺": [121.17254787217897, 30.899881037614236], "上海都市旅游观光巴士": [121.47894116094564, 31.236008984257698], "东方绿舟": [121.02017563599946, 31.107361709264083], "赵屯妍妍草莓园": [121.09900611533251, 31.274890557987312], "平安号黄浦江游船": [121.52588392276022, 31.25010011692848], "崇明西沙湿地公园": [121.25992386355723, 31.745099490679873], "宝燕乐园（旗舰店）": [121.40332748849126, 31.09377914130984], "船长号游船浦江游览": [121.5232030934573, 31.25668992186789], "马陆葡萄主题公园": [121.32212748493485, 31.387282228868603], "孙桥现代农业开发区": [121.62473123687376, 31.167727427816644], "荷花博览园": [121.22871203110448, 31.767284760331226], "上海植物园": [121.45672451161535, 31.15265476779035], "安徒生童话乐园": [121.51729450693152, 31.328522069445793], "黄浦江游船": [121.5033243453015, 31.246165133675472], "迪士尼小镇": [121.66745350967352, 31.145925840699682], "上海滨海森林公园": [121.91687166277485, 30.978863601714814], "方塔园": [121.25239792736755, 31.01219507138659], "上海全华水彩艺术馆": [121.060006208566, 31.11977488368167], "静安公园": [121.45313005710027, 31.229176648970757], "NBA乐园": [121.48558591063345, 31.226807252092456], "上海新浜牡丹园": [121.05699443453013, 30.951133839484655], "中国农民画村": [121.02469303744296, 30.933903616703894], "清潭洞韩国温泉馆": [121.26623998075048, 31.35344130862699], "古猗园": [121.32144994249548, 31.298196757442884], "多乐岛蹦床公园": [121.49593537375291, 31.326315738333207], "外滩": [121.49687990965766, 31.242706236913193], "上海海洋水族馆": [121.50854982169035, 31.246011505504946], "秋水怡人汗蒸汤池": [121.32714783954863, 31.25420653177955], "南京路步行街": [121.49607206403445, 31.227203440768868], "闵行体育公园": [121.37142846849288, 31.153615967949772], "上海东方地质科普馆": [121.78821767802629, 31.18294668771739], "上海大转盘": [121.41499293774217, 31.145742253365725], "中国航海博物馆": [121.92599413938132, 30.90330034433685], "威久真人CS镭射拓展基地": [121.62543010418763, 31.336963494794656], "77真人密室逃脱（五角场店）": [121.52216851050991, 31.304703492251466], "辰山植物园": [121.18664271681718, 31.07601238580582], "南翔古镇": [121.30686970566141, 31.312270351018675], "延艺堂": [121.06203266272864, 31.11538870192683], "上海中心大厦": [121.51271813981604, 31.238484734981984], "上海迪士尼乐园": [121.70119533515441, 31.19844913145745], "上海大世界": [121.48538104757036, 31.234262446357306], "波兰倒置屋": [121.02469303744296, 30.933903616703894], "上海野生动物园": [121.7699041751199, 31.051897976820506], "上海名人蜡像馆": [121.21941567668689, 31.26767222864919], "长兴岛郊野公园": [121.68630666242858, 31.413299997024822], "上海香草园": [121.6384813140922, 31.23089534913395], "上海历史发展陈列馆": [121.5064701060957, 31.245341811634674], "上海大观园": [120.91752316801688, 31.078614886780972], "御翔飞行体验中心": [121.413273260301, 31.142509138302405], "豫园": [121.49952533763876, 31.23152628847996], "碧海金沙水上乐园": [121.5385905745718, 30.829339866513067], "上海玻璃博物馆": [121.47830661140797, 31.350010889579476], "上海周浦花海": [121.65799929333376, 31.126392520218914], "公元2050/2500未来生活体验馆": [121.39124513655149, 31.244816815312955], "星愿公园": [121.6384813140922, 31.23089534913395], "极乐汤（金沙江温泉馆）": [121.37257972156327, 31.23839737326497], "大观园梅园": [120.91752316801688, 31.078614886780972], "外滩观光隧道": [121.49699406542358, 31.245519611511487], "中山公园": [121.42741999286207, 31.226187184759517], "人文艺术馆": [121.06186345520787, 31.115054629543458], "松江雪浪湖温泉": [121.09129132747717, 30.932236374768852], "七宝古镇": [121.36295174598871, 31.15673023703752], "城隍庙旅游区": [121.49915585290452, 31.233197706460075], "复兴公园": [121.47379918205394, 31.223445876545135], "召稼楼": [121.51947519386209, 31.06060776237853], "上海动物园": [121.37291440414542, 31.196211390619435], "城市猎人射箭馆": [121.44569037800227, 31.198526914141944], "陆家嘴": [121.6384813140922, 31.23089534913395], "上海外滩星空艺术馆": [121.50508102843814, 31.233282813579113], "都市菜园": [121.59646761615556, 30.868375335174893], "上海欢乐谷": [121.22401342886333, 31.099950036076248], "圆津禅院": [121.06121101591597, 31.116382014041232], "上海世纪公园": [121.56291524151013, 31.227512844864133], "青浦草莓姑娘庄园": [121.1690957110533, 31.251409407949442], "上海浦江源温泉农庄": [121.1767260078856, 30.957765851150665], "上海黄浦江游览（世博大道）": [121.49904503164868, 31.193700433468692], "东方明珠": [121.5063729732192, 31.244937070519477], "魅力东方-上海杂技变脸飞车秀": [121.50123148659894, 31.169484816605408], "汤连得": [121.44856167053095, 31.33360116759906], "威久真人CS镭射拓展基地（虹口店）": [121.49295159001844, 31.260028753113428], "枫泾古镇": [121.02063324270762, 30.889780496515108], "地球尔儿童职业体验馆": [121.36104673644287, 31.163573421741518], "月湖雕塑公园": [121.21442033449172, 31.104186115053565], "南翔历史文化陈列馆": [121.31431516355876, 31.297786244992253], "东方瓜果乐园": [121.69706902538758, 31.090241363968126], "赵屯玮玮草莓农家": [121.08778963019245, 31.263632610567555], "东滩湿地公园": [121.90143388822976, 31.52830454667017], "南京西路": [121.45475555700204, 31.23538080348789], "上海游龙石文化科普馆": [121.6994361646098, 31.169214285454252], "大悦城屋顶摩天轮": [121.47867741395638, 31.24893387835124], "上海博物馆": [121.48250018539308, 31.234389721752343], "上弦机械真人密室逃脱（莘庄店）": [121.38184144899834, 31.111313972168336], "黄浦公园": [121.49748641140239, 31.247498524396942], "上海市上引温泉酒店": [121.45976254312126, 31.146856062717895], "龙美术馆浦东馆": [121.58053310920586, 31.22206306307818], "震旦博物馆": [121.50643143853502, 31.240419231157052], "上海人民公园": [121.48043696448421, 31.242711242021976], "上海纸箱王文创园区": [121.35320423379825, 31.150468801533883], "上海城隍庙": [121.49918988251385, 31.231085650198086], "上海人民广场": [121.48130241985999, 31.235156971414238], "都市观光旅游巴士": [121.49719312004322, 31.246140964857126], "赵屯扬扬草莓园": [121.09710815928153, 31.258569778420984], "汤连得(长清店)": [121.49754279803925, 31.155457688886738], "光明瑞华果园": [121.33775695607916, 31.81813257332507], "东方明珠公园": [121.50632249204276, 31.24733999165456], "朱家角城隍庙": [121.06265963056781, 31.115470121920293], "大清邮局": [121.06014248151186, 31.113183552877178], "立秀宝儿童社会体验英语小镇": [121.5144645391512, 31.336141921905362]};
                // var data = [{"name": "东方明珠", "value": 40}, {"name": "上海杜莎夫人蜡像馆", "value": 29}, {"name": "黄浦江游船", "value": 27}, {"name": "豫园", "value": 8}, {"name": "外滩", "value": 4}, {"name": "外滩观光隧道", "value": 6}, {"name": "金茂大厦88层观光厅", "value": 7}, {"name": "磁浮列车", "value": 3}, {"name": "上海迪士尼乐园", "value": 588}, {"name": "上海科技馆", "value": 11}, {"name": "环球金融中心观光厅", "value": 5}, {"name": "上海中心大厦", "value": 13}, {"name": "上海海洋水族馆", "value": 21}, {"name": "东方明珠豪华浦江游船东方明珠码头", "value": 10}, {"name": "上海野生动物园", "value": 36}, {"name": "上海影视乐园", "value": 20}, {"name": "上海欢乐谷", "value": 24}, {"name": "上海城隍庙", "value": 0}, {"name": "东方明珠空中旋转餐厅", "value": 1}, {"name": "朱家角古镇", "value": 2}, {"name": "南京路步行街", "value": 0}, {"name": "陆家嘴", "value": 0}, {"name": "上海博物馆", "value": 2}, {"name": "上海人民广场", "value": 0}, {"name": "城隍庙旅游区", "value": 1}, {"name": "上海自然博物馆", "value": 5}, {"name": "上海历史发展陈列馆", "value": 1}, {"name": "上海星空错觉艺术馆", "value": 1}, {"name": "平安号黄浦江游船", "value": 0}, {"name": "城隍庙九曲桥", "value": 0}, {"name": "奇人异事展", "value": 0}, {"name": "上海动物园", "value": 29}, {"name": "都市观光旅游巴士", "value": 0}, {"name": "大悦城屋顶摩天轮", "value": 0}, {"name": "上海电影博物馆", "value": 0}, {"name": "上海长风海洋世界", "value": 8}, {"name": "时光弄堂", "value": 0}, {"name": "上海世纪公园", "value": 15}, {"name": "3D魔幻趣味馆", "value": 1}, {"name": "上海迪士尼摄影服务", "value": 0}, {"name": "外滩观光隧道AR体验馆", "value": 0}, {"name": "顾村公园", "value": 41}, {"name": "上海外滩星空艺术馆", "value": 0}, {"name": "上海汽车博物馆", "value": 2}, {"name": "泰晤士小镇", "value": 0}, {"name": "环球奇趣体验馆", "value": 0}, {"name": "上海周浦花海", "value": 12}, {"name": "ERA时空之旅", "value": 1}, {"name": "南翔古镇", "value": 0}, {"name": "琉璃中国博物馆", "value": 0}, {"name": "锦江乐园", "value": 0}, {"name": "上海马戏城", "value": 1}, {"name": "上海大观园", "value": 3}, {"name": "上海观复博物馆", "value": 0}, {"name": "七宝古镇", "value": 0}, {"name": "公元2050/2500未来生活体验馆", "value": 0}, {"name": "上海都市旅游观光巴士", "value": 0}, {"name": "上海顾村恐龙园", "value": 12}, {"name": "枫泾古镇", "value": 1}, {"name": "上海大自然野生昆虫馆", "value": 1}, {"name": "上海JOYPOLIS乐园", "value": 0}, {"name": "上海黄浦江游览（世博大道）", "value": 0}, {"name": "东平国家森林公园", "value": 3}, {"name": "上海星期8小镇", "value": 0}, {"name": "上海植物园", "value": 0}, {"name": "方塔园", "value": 1}, {"name": "南翔老街", "value": 0}, {"name": "草莓人家", "value": 0}, {"name": "上海风电科普馆", "value": 0}, {"name": "上海人民公园", "value": 0}, {"name": "东方绿舟", "value": 7}, {"name": "碧海金沙水上乐园", "value": 1}, {"name": "御翔飞行体验中心", "value": 0}, {"name": "上海城市规划展示馆", "value": 0}, {"name": "船长号游船浦江游览", "value": 0}, {"name": "圆津禅院", "value": 0}, {"name": "辰山植物园", "value": 7}, {"name": "高家庄园", "value": 0}, {"name": "上海泰迪之家博物馆", "value": 0}, {"name": "上海历史博物馆", "value": 0}, {"name": "中国农民画村", "value": 0}, {"name": "南翔历史文化陈列馆", "value": 0}, {"name": "震旦博物馆", "value": 0}, {"name": "上海大转盘", "value": 0}, {"name": "上海名人蜡像馆", "value": 0}, {"name": "朱家角城隍庙", "value": 0}, {"name": "上海尊木艺术馆", "value": 0}, {"name": "哈一顿桑拿（七宝店）", "value": 0}, {"name": "上海格里芬汽车影院", "value": 0}, {"name": "古猗园", "value": 0}, {"name": "上海海湾国家森林公园", "value": 3}, {"name": "太敬机器人科技文化体验馆", "value": 0}, {"name": "波兰倒置屋", "value": 0}, {"name": "大鸭软陶屋", "value": 0}, {"name": "龙美术馆浦东馆", "value": 0}, {"name": "人文艺术馆", "value": 0}, {"name": "上海成龙电影艺术馆", "value": 0}, {"name": "宝燕乐园（旗舰店）", "value": 0}, {"name": "黄浦公园", "value": 0}, {"name": "乾汤国际温泉", "value": 0}, {"name": "东滩湿地公园", "value": 1}, {"name": "长风公园", "value": 0}, {"name": "魅力东方-上海杂技变脸飞车秀", "value": 0}, {"name": "大清邮局", "value": 0}, {"name": "朱家角课植园", "value": 0}, {"name": "鲜花港", "value": 1}, {"name": "召稼楼", "value": 0}, {"name": "申迪生态园上农嘉年华", "value": 0}, {"name": "安徒生童话乐园", "value": 0}, {"name": "秋水怡人汗蒸汤池", "value": 0}, {"name": "星愿公园", "value": 0}, {"name": "上海大世界", "value": 0}, {"name": "檀园", "value": 0}, {"name": "上海陶瓷科技馆展览", "value": 0}, {"name": "多乐岛蹦床公园", "value": 0}, {"name": "崇明西沙湿地公园", "value": 0}, {"name": "东林寺", "value": 0}, {"name": "极乐汤（金沙江温泉馆）", "value": 0}, {"name": "云翔寺", "value": 0}, {"name": "鲁迅公园", "value": 0}, {"name": "汤连得(长清店)", "value": 0}, {"name": "闵行体育公园", "value": 0}, {"name": "喜魔谷主题游戏馆", "value": 0}, {"name": "橙蓝生态体验乐园", "value": 0}, {"name": "赵屯妍妍草莓园", "value": 0}, {"name": "上海世博会博物馆", "value": 0}, {"name": "上弦机械真人密室逃脱（莘庄店）", "value": 0}, {"name": "威久真人CS镭射拓展基地（普陀店）", "value": 0}, {"name": "迪士尼小镇", "value": 0}, {"name": "延艺堂", "value": 0}, {"name": "桂林公园", "value": 0}, {"name": "童天和药号", "value": 0}, {"name": "NBA乐园", "value": 0}, {"name": "南京西路", "value": 0}, {"name": "威久真人CS镭射拓展基地", "value": 0}, {"name": "涟泉大江户（上海莘庄店）", "value": 0}, {"name": "上海纸箱王文创园区", "value": 0}, {"name": "城市飞行会", "value": 0}, {"name": "77真人密室逃脱（五角场店）", "value": 0}, {"name": "瀛东生态村", "value": 0}, {"name": "集合石大型真人游戏馆（南京东路步行街店）", "value": 0}, {"name": "威久真人CS镭射拓展基地（虹口店）", "value": 0}, {"name": "长兴岛郊野公园", "value": 0}, {"name": "环球猎奇馆", "value": 0}, {"name": "上海八音盒珍品陈列馆", "value": 0}, {"name": "77真人密室逃脱（徐家汇店）", "value": 0}, {"name": "立秀宝儿童社会体验英语小镇", "value": 0}, {"name": "中山公园", "value": 0}, {"name": "地球尔儿童职业体验馆", "value": 0}, {"name": "上海相东佛像艺术馆", "value": 0}, {"name": "上海全华水彩艺术馆", "value": 0}, {"name": "上海手工艺展示馆", "value": 0}, {"name": "青浦草莓姑娘庄园", "value": 0}, {"name": "嘉仕有机农场", "value": 0}, {"name": "中国航海博物馆", "value": 0}, {"name": "静安公园", "value": 0}, {"name": "复兴公园", "value": 0}, {"name": "极乐汤碧云温泉馆", "value": 0}, {"name": "上海滨海森林公园", "value": 1}, {"name": "汤连得温泉馆", "value": 0}, {"name": "月湖雕塑公园", "value": 0}, {"name": "大观园梅园", "value": 0}, {"name": "闻道园", "value": 0}, {"name": "pulupulu主题游戏馆", "value": 0}, {"name": "上海东方地质科普馆", "value": 0}, {"name": "上海浦江源温泉农庄", "value": 0}, {"name": "上海玻璃博物馆", "value": 0}, {"name": "金山城市沙滩", "value": 0}, {"name": "一米单车之家", "value": 0}, {"name": "东方明珠公园", "value": 0}, {"name": "江南三民文化村", "value": 0}, {"name": "清潭洞韩国温泉馆", "value": 0}, {"name": "城市猎人射箭馆", "value": 0}, {"name": "青浦草莓园小苹果农家乐", "value": 0}, {"name": "MIKU谜窟真人实景游戏", "value": 0}, {"name": "RU KIDDING密室逃脱", "value": 0}, {"name": "赵屯玮玮草莓农家", "value": 0}, {"name": "亲子彩虹泡泡跑", "value": 0}, {"name": "东方瓜果乐园", "value": 0}, {"name": "上海游龙石文化科普馆", "value": 0}, {"name": "崇明明珠湖公园", "value": 1}, {"name": "松江雪浪湖温泉", "value": 0}, {"name": "大宁灵石公园", "value": 0}, {"name": "马陆葡萄主题公园", "value": 0}, {"name": "上海香草园", "value": 0}, {"name": "家家乐梦幻乐园", "value": 0}, {"name": "孙桥现代农业开发区", "value": 0}, {"name": "荷花博览园", "value": 0}, {"name": "上海市上引温泉酒店", "value": 0}, {"name": "赵屯张家草莓园", "value": 0}, {"name": "赵屯乡村草莓园", "value": 0}, {"name": "赵屯扬扬草莓园", "value": 0}, {"name": "金山嘴渔村", "value": 0}, {"name": "光明瑞华果园", "value": 0}, {"name": "花开海上生态园", "value": 0}, {"name": "都市菜园", "value": 0}, {"name": "黄浦江游览", "value": 5}, {"name": "前卫生态村", "value": 0}, {"name": "廊下生态园", "value": 0}, {"name": "汤连得", "value": 0}, {"name": "上海新浜牡丹园", "value": 0}, {"name": "精彩上海旅游联票", "value": 0}];

                var geoCoordMap = [];
                var data = [];
                $.ajaxSetup({async: false});
                $.getJSON('/static/new/aaa.json', function (data1) {
                    // dd = convertData(data1.geoCoordMap,data1.data);
                    geoCoordMap = data1.geoCoordMap;
                    data = data1.data;
                    // alert(dd);
                });
                $.ajaxSetup({async: true});
                var max = 480,
                    min = 9; // todo
                var maxSize4Pin = 100,
                    minSize4Pin = 20;

                var convertData = function (data) {
                    var res = [];
                    for (var i = 0; i < data.length; i++) {
                        var geoCoord = geoCoordMap[data[i].name];
                        if (geoCoord) {
                            res.push({
                                name: data[i].name,
                                value: geoCoord.concat(data[i].value)
                            });
                        }
                    }
                    return res;
                };


                var option2 = {
                    title: {
                        show: false,
                        text: '上海',
                        subtext: '',
                        x: 'center',
                        textStyle: {
                            color: '#ccc'
                        }
                    },
                    tooltip: {
                        trigger: 'item',
                        formatter: '{b}'
                    },
                    legend: {
                        orient: 'vertical',
                        y: 'bottom',
                        x: 'right',
                        data: ['credit_pm2.5'],
                        textStyle: {
                            color: '#fff'
                        }
                    },
                    geo: {
                        show: true,
                        map: params.name,
                        label: {
                            normal: {
                                show: true,
                                textStyle: {
                                    color: '#999',
                                    fontSize: 13
                                }
                            },
                            emphasis: {
                                show: false,
                            }
                        },
                        roam: true,
                        itemStyle: {
                            normal: {
                                areaColor: '#031525',
                                borderColor: '#3B5077',
                            },
                            emphasis: {
                                areaColor: '#2B91B7',
                            }
                        }
                    },
                    series: [{
                        name: 'credit_pm2.5',
                        type: 'scatter',
                        coordinateSystem: 'geo',
                        data: convertData(data),
                        symbolSize: function (val) {
                            return val[2] / 10;
                        },
                        label: {
                            normal: {
                                formatter: '{b}',
                                position: 'right',
                                show: true
                            },
                            emphasis: {
                                show: true
                            }
                        },
                        itemStyle: {
                            normal: {
                                color: '#05C3F9'
                            }
                        }
                    }, {
                        type: 'map',
                        map: params.name,
                        geoIndex: 0,
                        aspectScale: 0.75, //长宽比
                        showLegendSymbol: false, // 存在legend时显示
                        label: {
                            normal: {
                                show: true,
                                textStyle: {
                                    color: '#999',
                                    fontSize: 13
                                }
                            },
                            emphasis: {
                                show: false,
                                textStyle: {
                                    color: '#fff'
                                }
                            }
                        },
                        roam: true,
                        itemStyle: {
                            normal: {
                                areaColor: '#031525',
                                borderColor: '#3B5077',
                            },
                            emphasis: {
                                areaColor: '#2B91B7'
                            }
                        },
                        animation: false,
                        data: data
                    }, {
                        name: '点',
                        type: 'scatter',
                        coordinateSystem: 'geo',
                        symbol: 'pin',
                        symbolSize: function (val) {
                            var a = (maxSize4Pin - minSize4Pin) / (max - min);
                            var b = minSize4Pin - a * min;
                            b = maxSize4Pin - a * max;
                            return a * val[2] + b;
                        },
                        label: {
                            normal: {
                                show: true,
                                textStyle: {
                                    color: '#fff',
                                    fontSize: 9,
                                }
                            }
                        },
                        itemStyle: {
                            normal: {
                                color: '#F62157', //标志颜色
                            }
                        },
                        zlevel: 6,
                        data: convertData(data),
                    }, {
                        name: 'Top 5',
                        type: 'effectScatter',
                        coordinateSystem: 'geo',
                        data: convertData(data.sort(function (a, b) {
                            return b.value - a.value;
                        }).slice(0, 5)),
                        symbolSize: function (val) {
                            return val[2] / 10;
                        },
                        showEffectOn: 'render',
                        rippleEffect: {
                            brushType: 'stroke'
                        },
                        hoverAnimation: true,
                        label: {
                            normal: {
                                formatter: '{b}',
                                position: 'right',
                                show: true
                            }
                        },
                        itemStyle: {
                            normal: {
                                color: '#05C3F9',
                                shadowBlur: 10,
                                shadowColor: '#05C3F9'
                            }
                        },
                        zlevel: 1
                    },

                    ]
                };
                chart.setOption(option2);
                chart.on('click', function (params) {
                    // console.log( params );

                    //如果是【直辖市/特别行政区】只有二级下钻
                    if (special.indexOf(params.seriesName) >= 0) {
                        renderMap('china', mapdata);
                    } else {
                        //显示县级地图
                        $.getJSON('/static/map/city/' + cityMap[params.name] + '.json', function (data) {
                            echarts.registerMap(params.name, data);
                            var d = [];
                            for (var i = 0; i < data.features.length; i++) {
                                d.push({
                                    name: data.features[i].properties.name
                                })
                            }
                            renderMap(params.name, d);
                        });
                    }

                });
            });
        } else if (params.seriesName in provinces) {
            //如果是【直辖市/特别行政区】只有二级下钻
            if (special.indexOf(params.seriesName) >= 0) {
                renderMap('china', mapdata);
            } else {
                //显示县级地图
                $.getJSON('/static/map/city/' + cityMap[params.name] + '.json', function (data) {
                    echarts.registerMap(params.name, data);
                    var d = [];
                    for (var i = 0; i < data.features.length; i++) {
                        d.push({
                            name: data.features[i].properties.name
                        })
                    }
                    renderMap(params.name, d);
                });
            }
        } else {
            renderMap('china', mapdata);
        }
    });

    //初始化绘制全国地图配置
    var option = {
        backgroundColor: '#000',
        title: {
            text: 'Echarts3 中国地图下钻至县级',
            subtext: '三级下钻',
            link: 'http://www.ldsun.com',
            left: 'center',
            textStyle: {
                color: '#fff',
                fontSize: 16,
                fontWeight: 'normal',
                fontFamily: "Microsoft YaHei"
            },
            subtextStyle: {
                color: '#ccc',
                fontSize: 13,
                fontWeight: 'normal',
                fontFamily: "Microsoft YaHei"
            }
        },
        tooltip: {
            trigger: 'item',
            formatter: '{b}'
        },
        toolbox: {
            show: true,
            orient: 'vertical',
            left: 'right',
            top: 'center',
            feature: {
                dataView: {readOnly: false},
                restore: {},
                saveAsImage: {}
            },
            iconStyle: {
                normal: {
                    color: '#fff'
                }
            }
        },
        animationDuration: 1000,
        animationEasing: 'cubicOut',


        animationDurationUpdate: 1000

    };

    function renderMap(map, data) {
        option.title.subtext = map;
        option.series = [
            {
                zlevel: 9,
                name: map,
                type: 'map',
                mapType: map,
                roam: false,
                nameMap: {
                    'china': '中国'
                },
                label: {
                    normal: {
                        show: true,
                        textStyle: {
                            color: '#999',
                            fontSize: 13
                        }
                    },
                    emphasis: {
                        show: true,
                        textStyle: {
                            color: '#fff',
                            fontSize: 13
                        }
                    }
                },
                itemStyle: {
                    normal: {
                        areaColor: '#323c48',
                        borderColor: 'dodgerblue'
                    },
                    emphasis: {
                        areaColor: 'darkorange'
                    }
                },
                data: data
            }
        ];
        //渲染地图
        chart.setOption(option, true);
    }
</script>
</body>
</html>
